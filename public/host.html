<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel host - Chachor Piecze</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="host-body">
  <script>
    if (sessionStorage.getItem("isHostLogged") !== "true") {
      window.location.href = "/host-login";
    }
  </script>

  <nav class="navbar">
    <ul class="nav-links">
      <li><a href="/index">Zamów</a></li>
      <li><a href="/accessibility">Dostępność i odbiory</a></li>
      <li><a href="/about">O nas</a></li>
    </ul>
  </nav>

  <main class="host-dashboard">
    <section class="host-card glass-panel host-stock-shortcut">
      <div class="panel-heading">
        <h2>Zarządzaj stanami dziennymi</h2>
        <p>Ustal domyślne ilości na poszczególne dni tygodnia lub przygotuj wyjątki dla konkretnych dat.</p>
      </div>
      <div class="host-card-actions">
        <a class="host-primary-btn host-primary-btn--wide" href="/host-stock">Przejdź do modułu stanów</a>
      </div>
    </section>

    <section class="host-card glass-panel host-orders-shortcut">
      <div class="panel-heading">
        <h2>Zamówienia i raporty</h2>
        <p>Przeglądaj codzienne zestawienia zamówień, które wysyłamy automatycznie na skrzynkę zamowienia@chachorpiecze.pl.</p>
      </div>
      <div class="host-card-actions">
        <a class="host-primary-btn host-primary-btn--wide" href="/host-orders">Zobacz zestawienia zamówień</a>
      </div>
    </section>

    <section class="host-section glass-panel">
      <div class="panel-heading">
        <h2>Dodaj nowy produkt</h2>
        <p>Wypełnij pola poniżej, aby dodać wypiek do oferty.</p>
      </div>

      <form id="hostForm" class="host-form" enctype="multipart/form-data">
        <div class="host-form-grid">
          <label class="host-field" for="name">
            <span>Nazwa produktu</span>
            <input type="text" id="name" placeholder="np. Drożdżówka z makiem" required>
          </label>
          <label class="host-field" for="price">
            <span>Cena</span>
            <input type="number" id="price" min="0" step="0.01" placeholder="np. 12" required>
          </label>
          <label class="host-field host-field--wide" for="desc">
            <span>Opis produktu</span>
            <textarea id="desc" placeholder="Kilka słów o składnikach i smaku" rows="3" required></textarea>
          </label>
          <label class="host-field" for="categorySelect">
            <span>Kategoria</span>
            <select id="categorySelect" required>
              <option value="">-- Wybierz kategorię --</option>
            </select>
          </label>
        </div>

        <div class="host-form-split">
          <div class="host-form-card" id="productAvailabilityPicker">
            <span class="host-form-card__label">Dni dostępności</span>
            <p class="host-form-card__hint">Zaznacz dni, w które wypiek będzie dostępny w sklepie.</p>
            <div class="host-product-availability__grid" id="productAvailabilityDays" role="group" aria-label="Dni tygodnia"></div>
            <label class="host-product-availability__toggle host-product-availability__toggle--all">
              <input type="checkbox" id="productAvailabilityAll">
              <span>Codziennie</span>
            </label>
          </div>

          <label class="host-field host-field--file" for="image">
            <span>Zdjęcie produktu</span>
            <input type="file" id="image" accept="image/*" required>
          </label>
        </div>

        <div class="host-form-card host-form-card--pickup-times" id="productPickupTimes" hidden aria-hidden="true">
          <span class="host-form-card__label">Godziny odbioru</span>
          <p class="host-form-card__hint">Wpisz godzinę, od której bochenek będzie gotowy w zaznaczonych dniach.</p>
          <div class="host-pickup-times-grid" id="productPickupTimesGrid"></div>
        </div>

        <div class="host-form-actions">
          <button type="submit" class="host-primary-btn">Dodaj produkt</button>
        </div>
      </form>

      <div id="hostMessage" class="host-message" aria-live="polite"></div>
    </section>

    <section id="categoriesSection" class="host-card glass-panel">
      <div class="panel-heading">
        <h2>Kategorie</h2>
        <p>Porządkuj ofertę według kategorii, aby ułatwić klientom znalezienie wypieków.</p>
        <p class="panel-hint">Dodaj grafikę kafelka, by wyróżnić kategorię na ekranie menu.</p>
      </div>

      <form id="categoryForm" class="host-inline-form">
        <label class="host-field" for="categoryName">
          <span>Nazwa kategorii</span>
          <input type="text" id="categoryName" placeholder="np. Słodkie" required>
        </label>
        <button type="submit" class="host-primary-btn host-primary-btn--compact">Dodaj kategorię</button>
      </form>
      <div id="categoryMessage" class="host-message" aria-live="polite"></div>

      <div id="categoryList" class="host-category-list"></div>
    </section>

    <section class="host-accessibility-section glass-panel host-card">
      <div class="host-availability-header">
        <h2>Sekcja "Dostępność i odbiory"</h2>
        <p>Dodaj lub zmień zdjęcie w tle hero, które otwiera stronę dostępności.</p>
      </div>

      <form id="accessibilityHeroForm" class="host-about-form" enctype="multipart/form-data">
        <label class="about-field">
          <span>Zdjęcie w tle</span>
          <input type="file" id="accessibilityHeroImage" name="accessibilityHeroImage" accept="image/*">
        </label>
        <div class="host-form-actions">
          <button type="submit" class="host-primary-btn">Zapisz zdjęcie</button>
          <button type="button" class="host-secondary-btn" id="accessibilityHeroRemove">Usuń zdjęcie</button>
        </div>
      </form>

      <div id="accessibilityHeroMessage" class="host-message" aria-live="polite"></div>

      <div class="host-about-preview host-accessibility-preview">
        <figure>
          <img id="accessibilityHeroPreviewImage" alt="Podgląd tła sekcji Dostępność i odbiory" hidden>
          <span id="accessibilityHeroNoImagePlaceholder">Brak zdjęcia — dodaj plik, by zaktualizować sekcję.</span>
        </figure>
        <p class="host-about-preview__text" id="accessibilityHeroPreviewText">Dostępność i odbiory. Sprawdź, co serwujemy w poszczególne dni tygodnia i kiedy możesz odebrać swoje wypieki.</p>
      </div>
    </section>

    <section class="host-availability-section glass-panel host-card host-card--wide">
      <div class="host-availability-header">
        <h2>Dostępność tygodniowa</h2>
        <p>Dodaj lub aktualizuj listę wypieków dostępnych w danym dniu wraz z godziną odbioru, a zmiany automatycznie pojawią się w sekcji dostępności.</p>
      </div>
      <div id="availabilityManager" class="availability-manager-grid"></div>
      <div id="availabilityMessage" class="availability-message" aria-live="polite"></div>
    </section>

    <section class="host-discount-section glass-panel host-card">
      <div class="host-discount-header">
        <h2>Kody rabatowe</h2>
        <p>Utwórz kod i przypisz procent rabatu, aby klienci mogli go wykorzystać w koszyku.</p>
      </div>

      <form id="discountForm" class="discount-form">
        <div class="discount-form-row">
          <label class="discount-field" for="discountCode">Kod</label>
          <input type="text" id="discountCode" placeholder="np. SMAK20" maxlength="40" required>
        </div>
        <div class="discount-form-row">
          <label class="discount-field" for="discountPercent">Rabat (%)</label>
          <input type="number" id="discountPercent" min="1" max="100" step="1" placeholder="np. 15" required>
        </div>
        <button type="submit" class="host-primary-btn">Dodaj kod</button>
      </form>
      <div id="discountMessage" class="discount-message" aria-live="polite"></div>

      <div id="discountList" class="discount-list"></div>
    </section>

    <section class="host-about-section glass-panel host-card host-card--wide">
      <div class="host-about-header">
        <h2>Sekcja "O nas"</h2>
        <p>Zaktualizuj zdjęcie i tekst, które wyświetlają się na stronie O nas.</p>
      </div>

      <form id="aboutForm" class="host-about-form" enctype="multipart/form-data">
        <label class="about-field">
          <span>Opis</span>
          <textarea id="aboutText" name="aboutText" placeholder="Opowiedz krótko o piekarni" required></textarea>
        </label>
        <label class="about-field">
          <span>Zdjęcie w tle</span>
          <input type="file" id="aboutImage" name="aboutImage" accept="image/*">
        </label>
        <button type="submit" class="host-primary-btn">Zapisz sekcję</button>
      </form>

      <div id="aboutMessage" class="host-message" aria-live="polite"></div>

      <div class="host-about-preview" id="aboutPreview">
        <figure>
          <img id="aboutPreviewImage" alt="Podgląd zdjęcia sekcji O nas" hidden>
          <span id="aboutNoImagePlaceholder">Brak zdjęcia — dodaj plik, by zaktualizować sekcję.</span>
        </figure>
        <p class="host-about-preview__text" id="aboutPreviewText"></p>
      </div>

      <div class="host-about-gallery">
        <div class="host-about-gallery__header">
          <h3>Galeria zdjęć</h3>
          <p>Dodaj zdjęcia, które pokażą klientów Waszą piekarnię od środka.</p>
        </div>
        <form id="aboutGalleryForm" class="host-about-gallery__form" enctype="multipart/form-data">
          <label class="about-field host-about-gallery__field">
            <span>Nowe zdjęcie</span>
            <input type="file" id="aboutGalleryImage" name="aboutGalleryImage" accept="image/*" required>
          </label>
          <button type="submit" class="host-primary-btn host-primary-btn--compact">Dodaj do galerii</button>
        </form>
        <div id="aboutGalleryMessage" class="host-message" aria-live="polite"></div>
        <div id="aboutGalleryList" class="host-gallery-grid"></div>
      </div>
    </section>

    <section id="products" class="products-section glass-panel host-card host-card--wide order-menu host-products-panel">
      <header class="order-menu-header host-products-header">
        <h2>Kafle sekcji "Zamów"</h2>
        <p>Podglądaj układ menu tak jak widzą go klienci i zarządzaj produktami bezpośrednio z kafelków.</p>
      </header>
      <div id="productGrid" class="category-container host-category-container" aria-live="polite"></div>
    </section>
  </main>

  <div id="productEditModal" class="modal host-edit-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="productEditModalTitle">
    <div class="modal-content host-edit-modal__content" role="document">
      <button type="button" class="modal-close" id="productEditClose" aria-label="Zamknij okno">×</button>
      <div class="host-edit-modal__header">
        <h3 id="productEditModalTitle">Edytuj kafelek</h3>
        <p id="productEditModalSubtitle">Zaktualizuj dane produktu, aby natychmiast zobaczyć zmiany w podglądzie.</p>
      </div>
      <form id="productEditForm" class="host-edit-form" enctype="multipart/form-data">
        <div class="host-form-grid">
          <label class="host-field" for="productEditName">
            <span>Nazwa produktu</span>
            <input type="text" id="productEditName" placeholder="np. Drożdżówka z makiem" required>
          </label>
          <label class="host-field" for="productEditPrice">
            <span>Cena</span>
            <input type="number" id="productEditPrice" min="0" step="0.01" placeholder="np. 12" required>
          </label>
          <label class="host-field host-field--wide" for="productEditDesc">
            <span>Opis produktu</span>
            <textarea id="productEditDesc" placeholder="Kilka słów o składnikach i smaku" rows="3" required></textarea>
          </label>
          <label class="host-field" for="productEditCategory">
            <span>Kategoria</span>
            <select id="productEditCategory" required>
              <option value="">-- Wybierz kategorię --</option>
            </select>
          </label>
        </div>
        <div class="host-form-split host-edit-form__split">
          <div class="host-form-card">
            <span class="host-form-card__label">Dni dostępności</span>
            <p class="host-form-card__hint">Zaznacz dni, w które kafelek ma być widoczny w sekcji "Zamów".</p>
            <div class="host-product-availability__grid" id="productEditAvailabilityDays" role="group" aria-label="Dni tygodnia"></div>
            <label class="host-product-availability__toggle host-product-availability__toggle--all">
              <input type="checkbox" id="productEditAvailabilityAll">
              <span>Codziennie</span>
            </label>
          </div>
          <div class="host-edit-image-field">
            <label class="host-field host-field--file" for="productEditImage">
              <span>Zdjęcie produktu</span>
              <input type="file" id="productEditImage" accept="image/*">
            </label>
            <div class="host-edit-image-preview">
              <img id="productEditImagePreview" alt="Podgląd zdjęcia produktu" hidden>
              <span id="productEditImagePlaceholder">Brak zdjęcia — zostanie użyte dotychczasowe.</span>
            </div>
          </div>
        </div>
        <div class="host-form-actions host-edit-form__actions">
          <button type="submit" class="host-primary-btn" id="productEditSave">Zapisz zmiany</button>
          <button type="button" class="host-secondary-btn" id="productEditCancel">Anuluj</button>
        </div>
        <div id="productEditMessage" class="host-message" aria-live="polite"></div>
      </form>
    </div>
  </div>

  <script src="host.js"></script>
</body>
</html>
